<!DOCTYPE html>
<head>
    <title>Slot Machine</title>
    <link rel="stylesheet" type="text/css" href="css/browser_reset.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
</head>
<html>
<body>
<main>
	<div class="status" id="status">SPIN TO WIN!</div>
	<div class="slots">
		<div id="slot1" class="a1"></div>
		<div id="slot2" class="a1"></div>
		<div id="slot3" class="a1"></div>
    </div>
	<button type="submit" value="Submit" class="button"  onclick="return gamble(y)" style="vertical-align:middle"><span>SPIN</span></button>
   
<div>
	<input type="image" src="images/blackjack/overig/10-chip.png" onCLick="addbet(10)" class="pokerchip" alt="10 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/25-chip.png" onCLick="addbet(25)" class="pokerchip" alt="25 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/50-chip.png" onCLick="addbet(50)" class="pokerchip" alt="50 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/100-chip.png" onCLick="addbet(100)" class="pokerchip" alt="100 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/200-chip.png" onCLick="addbet(200)" class="pokerchip" alt="200 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/500-chip.png" onCLick="addbet(500)" class="pokerchip" alt="500 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/1000-chip.png" onCLick="addbet(1000)" class="pokerchip" alt="1000 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/2000-chip.png" onCLick="addbet(2000)" class="pokerchip" alt="2000 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/10000-chip.png" onCLick="addbet(10000)" class="pokerchip" alt="10000 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/50000-chip.png" onCLick="addbet(50000)" class="pokerchip" alt="50000 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/100000-chip.png" onCLick="addbet(100000)" class="pokerchip" alt="100000 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/500000-chip.png" onCLick="addbet(500000)" class="pokerchip" alt="500000 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/1mil-chip.png" onCLick="addbet(1000000)" class="pokerchip" alt="1000000 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/10mil-chip.png" onCLick="addbet(10000000)" class="pokerchip" alt="10000000 poker chip" width="150" height=auto>
	<input type="image" src="images/blackjack/overig/allin-chip.png" onCLick="addbet(100)" class="pokerchip" alt="All in poker chip" width="150" height=auto>

</div>

<div class="status">
<table>
	<tr>
		<td id="message1">Money: $1000</td>
		<td id="message2">Now Betting: $0</td>
    </tr>
	</table>
</div>
</main>


<script>
var action = false;
let status = document.getElementById("status");

var x = 1000; // money
var y = 0;    // current bet

function addbet(amount) {
	// check of je genoeg geld hebt
	if (y + amount > x) {
		status.innerHTML = "Not enough funds.";
		return;
	}

	y += amount;
	status.innerHTML = "Bet placed.";
	document.getElementById("message2").innerHTML = "Now Betting: $" + y;
}

function gamble(y){
	if (action) return;

	if (y <= 0) {
		status.innerHTML = "Place a bet first!";
		return;
	}

	if (y > x) {
		status.innerHTML = "Not enough funds.";
		return;
	}

	action = true;

	var numChanges = randomInt(1,4) * 7;
	var numberSlot1 = numChanges + randomInt(1,7);
	var numberSlot2 = numChanges + 2 * 7 + randomInt(1,7);
	var numberSlot3 = numChanges + 4 * 7 + randomInt(1,7);

	var i1 = 0, i2 = 0, i3 = 0;

	status.innerHTML = "SPINNING";

	slot1 = setInterval(spin1, 50);
	slot2 = setInterval(spin2, 50);
	slot3 = setInterval(spin3, 50);

	function spin1(){
		i1++;
		if (i1 >= numberSlot1){
			clearInterval(slot1);
			return;
		}
		updateSlot("slot1");
	}

	function spin2(){
		i2++;
		if (i2 >= numberSlot2){
			clearInterval(slot2);
			return;
		}
		updateSlot("slot2");
	}

	function spin3(){
		i3++;
		if (i3 >= numberSlot3){
			clearInterval(slot3);
			testWin();
			return;
		}
		updateSlot("slot3");
	}
}

function updateSlot(id){
	let slotTile = document.getElementById(id);
	let current = parseInt(slotTile.className.substring(1));
	current = (current >= 7) ? 0 : current + 1;
	slotTile.className = "a" + current;
}

function testWin(){
	var slot1 = document.getElementById("slot1").className;
	var slot2 = document.getElementById("slot2").className;
	var slot3 = document.getElementById("slot3").className;

	let win =
		(slot1 === slot2 && slot2 === slot3 && slot1 !== "a7") ||
		(slot1 === slot2 && slot3 === "a7") ||
		(slot1 === slot3 && slot2 === "a7") ||
		(slot2 === slot3 && slot1 === "a7");

	if (win) {
		status.innerHTML = "YOU WIN!";
		x += y;
	} else {
		status.innerHTML = "YOU LOSE!";
		x -= y;
	}

	if (x < 0) x = 0;
	y = 0;

	document.getElementById("message1").innerHTML = "Money: $" + x;
	document.getElementById("message2").innerHTML = "Now Betting: $0";

	action = false;
}

function randomInt(min, max){
	return Math.floor(Math.random() * (max - min + 1)) + min;
}
</script>



</body>
</html>